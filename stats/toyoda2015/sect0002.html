<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="shortcut icon" href="icons/pyfav.png" type="image/png" />
<link href="index.html" title="基礎からのベイズ統計学" rel="start" />
<link href="index.html" title="基礎からのベイズ統計学" rel="first" />
<link href="index.html" rel="contents" title="Contents" />
<link rel="index" title="Index" />
<link href="sect0003.html" rel="next" />
<link href="sect0001.html" rel="prev" />
<link href="index.html" rel="parent" />
<meta name="aesop" content="information" />
<title>5 ハミルトニアンモンテカルロ法</title>
</head>
<body>
<div class="navigation">
<div id="top-navigation-panel" xml:id="top-navigation-panel">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="4 メトロポリス・ヘイスティングス法" href="sect0001.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="基礎からのベイズ統計学" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="正規分布に関する推測" href="sect0003.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">基礎からのベイズ統計学</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0001.html" class="sectref" rel="prev">メトロポリス・ヘイスティングス法</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">基礎からのベイズ統計学</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0003.html" class="sectref" rel="next">正規分布に関する推測</a></span>
</div>
<hr /></div>
</div>



<div><h1 id="a0000000003">5 ハミルトニアンモンテカルロ法</h1>
<h2 id="a0000000032">5.4 ハミルトニアン</h2>
<p>質量<img src="images/img-0040.png" alt="$m=1$" style="vertical-align:0px; 
                                     width:43px; 
                                     height:12px" class="math gen" />、重力加速度<img src="images/img-0041.png" alt="$g=1$" style="vertical-align:-3px; 
                                     width:37px; 
                                     height:15px" class="math gen" />の下で、運動エネルギーとポテンシャルエネルギーはそれぞれ  </p><table id="a0000000033" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000034">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0042.png" alt="$\displaystyle  K(p)=\frac{1}{2}p^2  $" style="vertical-align:-11px; width:85px; 
                   height:34px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.34</span>)</span></td>
</tr><tr id="a0000000035">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0043.png" alt="$\displaystyle U(\theta )=h(\theta )  $" style="vertical-align:-4px; width:84px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.35</span>)</span></td>
</tr>
</table><p> となるので<a href="#a0000000036" class="footnote"><sup class="footnotemark">1</sup></a>、ハミルトニアンは </p><table id="a0000000037" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0044.png" alt="\begin{equation}  H(\theta , p) = U(\theta )+K(p) = h(\theta ) + \frac{1}{2} p^2 \end{equation}" style="width:265px; 
                            height:35px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.36</span>)</span></td>
</tr>
</table><p> となる。 </p><h5 id="a0000000038">位相空間</h5>
<p> 位置と運動量を座標とする空間 </p><p>位相空間においては、 </p><ul class="itemize">
<li><p>可逆 </p></li><li><p>体積保存 </p></li>
</ul><p> が成り立つ。 </p><p>ここで、物体はハミルトニアンが常に一定になるように運動する。 つまりハミルトニアンを時間<img src="images/img-0045.png" alt="$\tau $" style="vertical-align:0px; 
                                     width:9px; 
                                     height:7px" class="math gen" />の関数とすると、  </p><table id="a0000000039" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0046.png" alt="\begin{equation}  \frac{dH(\tau )}{d \tau } =0 \end{equation}" style="width:78px; 
                            height:36px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.18</span>)</span></td>
</tr>
</table><p> が成り立つ。 ここから、物体の動きを予測するハミルトンの運動方程式  </p><table id="a0000000040" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000041">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0047.png" alt="$\displaystyle  \frac{d p(\tau )}{d \tau }  $" style="vertical-align:-11px; width:40px; 
                   height:37px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0048.png" alt="$\displaystyle = -h’(\theta (\tau ))  $" style="vertical-align:-4px; width:85px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.27</span>)</span></td>
</tr><tr id="a0000000042">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0049.png" alt="$\displaystyle \frac{\theta (\tau )}{d \tau }  $" style="vertical-align:-11px; width:31px; 
                   height:37px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0050.png" alt="$\displaystyle = p(\tau )  $" style="vertical-align:-4px; width:45px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.28</span>)</span></td>
</tr>
</table><p> が導かれる。 </p><h5 id="a0000000043">リープフロッグ法</h5>
<p> ハミルトンの運動方程式を数値的に解く方法  </p><table id="a0000000044" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000045">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0051.png" alt="$\displaystyle  p \left(\tau +\frac{1}{2} \right)  $" style="vertical-align:-16px; width:75px; 
                   height:40px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0052.png" alt="$\displaystyle = p(\tau ) - \frac{\epsilon }{2} h’(\theta (\tau ))  $" style="vertical-align:-12px; width:135px; 
                   height:30px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.31</span>)</span></td>
</tr><tr id="a0000000046">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0053.png" alt="$\displaystyle \theta (\tau +1)  $" style="vertical-align:-4px; width:57px; 
                   height:18px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0054.png" alt="$\displaystyle = \theta (\tau ) + \epsilon p \left( \tau +\frac{1}{2} \right)  $" style="vertical-align:-16px; width:148px; 
                   height:40px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.32</span>)</span></td>
</tr><tr id="a0000000047">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0055.png" alt="$\displaystyle p(\tau +1)  $" style="vertical-align:-4px; width:58px; 
                   height:18px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0056.png" alt="$\displaystyle = p \left(\tau +\frac{1}{2} \right) - \frac{\epsilon }{2} h’(\theta (\tau +1))  $" style="vertical-align:-16px; width:210px; 
                   height:40px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.33</span>)</span></td>
</tr>
</table><h2 id="a0000000048">5.5 HMC法</h2>
<h5 id="a0000000049">HMC法</h5>
<p> 事後分布<img src="images/img-0057.png" alt="$f(\theta |\bm@general \boldmath \m@ne \mv@bold \bm@command {x})$" style="vertical-align:-4px; 
                                     width:43px; 
                                     height:18px" class="math gen" />と、それとは独立な標準正規分布<img src="images/img-0058.png" alt="$f(p)$" style="vertical-align:-4px; 
                                     width:28px; 
                                     height:18px" class="math gen" />との同時分布  </p><table id="a0000000050" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0059.png" alt="\begin{equation}  f(\theta ,p|\bm@general \boldmath \m@ne \mv@bold \bm@command {x}) = f(\theta |\bm@general \boldmath \m@ne \mv@bold \bm@command {x})f(p) \end{equation}" style="width:158px; 
                            height:18px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.37</span>)</span></td>
</tr>
</table><p> を考え、この同時分布から乱数を発生させる<a href="#a0000000051" class="footnote"><sup class="footnotemark">2</sup></a>。 </p><p>このとき、<img src="images/img-0060.png" alt="$-h(\theta )=\log (f(\theta | \bm@general \boldmath \m@ne \mv@bold \bm@command {x}))$" style="vertical-align:-4px; 
                                     width:143px; 
                                     height:18px" class="math gen" />とおくと、  </p><table id="a0000000052" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000053">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0061.png" alt="$\displaystyle  f(\theta ,p|\bm@general \boldmath \m@ne \mv@bold \bm@command {x}) $" style="vertical-align:-4px; width:59px; 
                   height:18px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0062.png" alt="$\displaystyle = \left( -h(\theta ) - \frac{1}{2} p^2 \right)  $" style="vertical-align:-16px; width:129px; 
                   height:40px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.44</span>)</span></td>
</tr><tr id="a0000000054">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0018.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0063.png" alt="$\displaystyle =\exp (-H(\theta ,p))  $" style="vertical-align:-4px; width:117px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.45</span>)</span></td>
</tr>
</table><p> が導かれる。 </p><p>事後分布とそれとは独立な標準正規分布との同時事後分布の確率密度関数は、負のハミルトニアンに等しい。 </p><p>ここで、位相空間の可逆性<a href="#a0000000055" class="footnote"><sup class="footnotemark">3</sup></a>と体積保存性<a href="#a0000000056" class="footnote"><sup class="footnotemark">4</sup></a>より、詳細釣り合い条件  </p><table id="a0000000057" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0064.png" alt="\begin{equation}  f(\theta ,p|\theta ’,p’)f(\theta ’,p’|\bm@general \boldmath \m@ne \mv@bold \bm@command {x}) = f(\theta ’,p’|\theta ,p)f(\theta ,p|\bm@general \boldmath \m@ne \mv@bold \bm@command {x}) \end{equation}" style="width:322px; 
                            height:18px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.48</span>)</span></td>
</tr>
</table><p> が成立するが、リープフロッグ法に導入した<img src="images/img-0065.png" alt="$\epsilon $" style="vertical-align:0px; 
                                     width:7px; 
                                     height:7px" class="math gen" />により数値計算上は完全には成立しない。 そこで、補正係数 </p><table id="a0000000058" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0066.png" alt="\begin{equation}  r=\frac{f(\theta ^{(a)},p^{(a)}|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})}{f(\theta ^{(t)},p^{(t)}|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})}=\exp (H(\theta ^{(t)},p^{(t)})-H(\theta ^{(a)},p^{(a)})) \approx 1 \end{equation}" style="width:416px; 
                            height:41px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.49</span>)</span></td>
</tr>
</table><p> を用いる<a href="#a0000000059" class="footnote"><sup class="footnotemark">5</sup></a>。 </p><h5 id="a0000000060">HMC法アルゴリズム</h5>
<ol class="enumerate">
<li value="1"><p>初期値<img src="images/img-0067.png" alt="$\theta ^{(1)},\epsilon ,L,T$" style="vertical-align:-3px; 
                                     width:78px; 
                                     height:17px" class="math gen" />を定める<a href="#a0000000061" class="footnote"><sup class="footnotemark">6</sup></a>。 </p></li><li value="2"><p><img src="images/img-0068.png" alt="$p^{(t)}$" style="vertical-align:-3px; 
                                     width:23px; 
                                     height:17px" class="math gen" />を標準正規分布から発生 </p></li><li value="3"><p>リープフロッグ法により<img src="images/img-0069.png" alt="$\theta ^{(t)},p^{(t)}$" style="vertical-align:-3px; 
                                     width:54px; 
                                     height:17px" class="math gen" />から<img src="images/img-0070.png" alt="$\theta ^{(a)}, p^{(a)}$" style="vertical-align:-3px; 
                                     width:58px; 
                                     height:17px" class="math gen" />に移動 </p></li><li value="4"><p>確率<img src="images/img-0071.png" alt="$r$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:7px" class="math gen" />で受容（<img src="images/img-0072.png" alt="$\theta ^{(t+1)}=\theta ^{(a)}$" style="vertical-align:0px; 
                                     width:87px; 
                                     height:14px" class="math gen" />） </p></li><li value="5"><p><img src="images/img-0073.png" alt="$T=t$" style="vertical-align:0px; 
                                     width:40px; 
                                     height:11px" class="math gen" />で終了 </p></li>
</ol><p>標準正規分布から乱数<img src="images/img-0074.png" alt="$p$" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />発生（運動量）、その時点での位置<img src="images/img-0029.png" alt="$\theta ^{(t)}$" style="vertical-align:0px; 
                                     width:22px; 
                                     height:14px" class="math gen" />と運動量<img src="images/img-0074.png" alt="$p$" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />からハミルトンの運動方程式に従って時間<img src="images/img-0075.png" alt="$L$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />後の物体の位置<img src="images/img-0076.png" alt="$\theta ^{(a)}$" style="vertical-align:0px; 
                                     width:24px; 
                                     height:14px" class="math gen" />と運動量<img src="images/img-0077.png" alt="$p^{(a)}$" style="vertical-align:-3px; 
                                     width:25px; 
                                     height:17px" class="math gen" />を予測。ハミルトニアンの比に従ってそれを<img src="images/img-0078.png" alt="$\theta ^{(t+1)}$" style="vertical-align:0px; 
                                     width:39px; 
                                     height:14px" class="math gen" />として受容。<img src="images/img-0074.png" alt="$p$" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />はその都度使い捨て<a href="#a0000000062" class="footnote"><sup class="footnotemark">7</sup></a>。 </p><h2 id="a0000000063">5.6 多次元の場合</h2>
<h5 id="a0000000064">HMC法アルゴリズム（母数が<img src="images/img-0079.png" alt="$d$" style="vertical-align:0px; 
                                     width:9px; 
                                     height:11px" class="math gen" />次元）</h5>
<ol class="enumerate">
<li value="1"><p>初期値<img src="images/img-0080.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(1)},\epsilon ,L,T$" style="vertical-align:-3px; 
                                     width:79px; 
                                     height:19px" class="math gen" />を定める<a href="#a0000000065" class="footnote"><sup class="footnotemark">8</sup></a>。 </p></li><li value="2"><p><img src="images/img-0081.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {p}^{(t)}$" style="vertical-align:-3px; 
                                     width:24px; 
                                     height:17px" class="math gen" />を標準正規分布から発生（独立な<img src="images/img-0079.png" alt="$d$" style="vertical-align:0px; 
                                     width:9px; 
                                     height:11px" class="math gen" />個） </p></li><li value="3"><p>リープフロッグ法により<img src="images/img-0082.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(t)},\bm@general \boldmath \m@ne \mv@bold \bm@command {p}^{(t)}$" style="vertical-align:-3px; 
                                     width:55px; 
                                     height:19px" class="math gen" />から<img src="images/img-0083.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(a)}, \bm@general \boldmath \m@ne \mv@bold \bm@command {p}^{(a)}$" style="vertical-align:-3px; 
                                     width:60px; 
                                     height:19px" class="math gen" />に移動 </p></li><li value="4"><p>確率<img src="images/img-0071.png" alt="$r$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:7px" class="math gen" />で受容（<img src="images/img-0084.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(t+1)}=\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(a)}$" style="vertical-align:0px; 
                                     width:89px; 
                                     height:16px" class="math gen" />） </p></li><li value="5"><p><img src="images/img-0073.png" alt="$T=t$" style="vertical-align:0px; 
                                     width:40px; 
                                     height:11px" class="math gen" />で終了 </p></li>
</ol><p>ただし、ハミルトニアンは  </p><table id="a0000000066" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0085.png" alt="\begin{equation}  H(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta },\bm@general \boldmath \m@ne \mv@bold \bm@command {p}) = h(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }) + \frac{1}{2} \sum _{i=1}^ d p_ i^2 \end{equation}" style="width:183px; 
                            height:48px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.55</span>)</span></td>
</tr>
</table><p> であり、  </p><table id="a0000000067" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000068">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0086.png" alt="$\displaystyle  h’(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }) = \left( \frac{dh(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta })}{d \theta _1}, \cdots , \frac{dh(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta })}{d \theta _ d} \right)  $" style="vertical-align:-16px; width:206px; 
                   height:41px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.57</span>)</span></td>
</tr><tr id="a0000000069">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0087.png" alt="$\displaystyle r = \exp \left( H(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(t)},\bm@general \boldmath \m@ne \mv@bold \bm@command {p}^{(t)}) - H(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta }^{(a)},\bm@general \boldmath \m@ne \mv@bold \bm@command {p}^{(a)}) \right)  $" style="vertical-align:-11px; width:271px; 
                   height:30px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.58</span>)</span></td>
</tr>
</table><p> を用いる。 </p><p>平均<img src="images/img-0088.png" alt="$\mu $" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />、分散<img src="images/img-0089.png" alt="$\sigma ^2$" style="vertical-align:0px; 
                                     width:16px; 
                                     height:14px" class="math gen" />の正規分布について事後分布<img src="images/img-0090.png" alt="$f(\mu ,\sigma ^2|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})$" style="vertical-align:-4px; 
                                     width:70px; 
                                     height:18px" class="math gen" />を推測したいとする。 <img src="images/img-0088.png" alt="$\mu $" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />と<img src="images/img-0089.png" alt="$\sigma ^2$" style="vertical-align:0px; 
                                     width:16px; 
                                     height:14px" class="math gen" />のいずれにも一様事前分布を設定した場合、<img src="images/img-0091.png" alt="$h(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta })$" style="vertical-align:-4px; 
                                     width:29px; 
                                     height:18px" class="math gen" />は  </p><table id="a0000000070" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0092.png" alt="\begin{equation}  \log (\mu ,\sigma ^2|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})=\frac{-n}{2}\log \sigma ^2 + \frac{-1}{2\sigma ^2}\sum _{i=1}^ n (x_ i - \mu )^2 + \mathrm{const.} \end{equation}" style="width:381px; 
                            height:45px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.59</span>)</span></td>
</tr>
</table><p> の右辺第2項までにマイナスをかけたものを取れば良い。 </p><p>また、<img src="images/img-0093.png" alt="$h’(\bm@general \boldmath \m@ne \mv@bold \bm@command {\theta })$" style="vertical-align:-4px; 
                                     width:33px; 
                                     height:18px" class="math gen" />には </p><table id="a0000000071" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000072">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0094.png" alt="$\displaystyle  \frac{d}{d\mu } \log f(\bm@general \boldmath \m@ne \mv@bold \bm@command {x}|\mu ,\sigma ^2)  $" style="vertical-align:-14px; width:118px; 
                   height:36px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0095.png" alt="$\displaystyle = \frac{1}{\sigma ^2} \sum _{i=1}^{n} (x_ i - \mu )  $" style="vertical-align:-20px; width:121px; 
                   height:45px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.60</span>)</span></td>
</tr><tr id="a0000000073">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0096.png" alt="$\displaystyle \frac{d}{d\sigma ^2} \log f(\bm@general \boldmath \m@ne \mv@bold \bm@command {x}|\mu ,\sigma ^2)  $" style="vertical-align:-11px; width:126px; 
                   height:33px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0097.png" alt="$\displaystyle = \frac{-n}{2 \sigma ^2} + \frac{1}{2 \sigma ^4} \sum _{i=1}^ n (x_ i-\mu )^2  $" style="vertical-align:-20px; width:187px; 
                   height:45px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>5.61</span>)</span></td>
</tr>
</table><p> を利用する。 </p></div>

<div id="footnotes">
<p><b>Footnotes</b></p>
<ol>
<li id="a0000000036"><img src="images/img-0035.png" alt="$\theta $" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />は位置、<img src="images/img-0098.png" alt="$p=mv$" style="vertical-align:-3px; 
                                     width:54px; 
                                     height:10px" class="math gen" />は運動量。</li><li id="a0000000051"><img src="images/img-0057.png" alt="$f(\theta |\bm@general \boldmath \m@ne \mv@bold \bm@command {x})$" style="vertical-align:-4px; 
                                     width:43px; 
                                     height:18px" class="math gen" />と<img src="images/img-0058.png" alt="$f(p)$" style="vertical-align:-4px; 
                                     width:28px; 
                                     height:18px" class="math gen" />は独立であるから、<img src="images/img-0099.png" alt="$f(\theta ,p|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})$" style="vertical-align:-4px; 
                                     width:59px; 
                                     height:18px" class="math gen" />から<img src="images/img-0035.png" alt="$\theta $" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />を発生させるのは<img src="images/img-0057.png" alt="$f(\theta |\bm@general \boldmath \m@ne \mv@bold \bm@command {x})$" style="vertical-align:-4px; 
                                     width:43px; 
                                     height:18px" class="math gen" />から<img src="images/img-0035.png" alt="$\theta $" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />を発生させるのと同じこと。</li><li id="a0000000055">遷移確率<img src="images/img-0100.png" alt="$f(\theta ’,p’|\theta ,p)=f(\theta ,p|\theta ’,p’)$" style="vertical-align:-4px; 
                                     width:189px; 
                                     height:18px" class="math gen" /></li><li id="a0000000056"><img src="images/img-0101.png" alt="$f(\theta ,p|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})=f(\theta ’,p’|\bm@general \boldmath \m@ne \mv@bold \bm@command {x})$" style="vertical-align:-4px; 
                                     width:152px; 
                                     height:18px" class="math gen" /></li><li id="a0000000059">遷移確率が等しいため、ランダムウォークMH法のように補正係数から提案分布の部分は消える。</li><li id="a0000000061"><img src="images/img-0075.png" alt="$L$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />はリープフロッグ法の遷移時間。</li><li id="a0000000062">注16（本文P.121）にあるように、<img src="images/img-0074.png" alt="$p$" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />の分散や<img src="images/img-0065.png" alt="$\epsilon $" style="vertical-align:0px; 
                                     width:7px; 
                                     height:7px" class="math gen" />、<img src="images/img-0075.png" alt="$L$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />は自動調節する必要がある。 第6章の章末問題を解くとわかるが、<img src="images/img-0102.png" alt="$M=73875, SD=4442$" style="vertical-align:-3px; 
                                     width:168px; 
                                     height:16px" class="math gen" />のようなデータだと、<img src="images/img-0088.png" alt="$\mu $" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />や<img src="images/img-0089.png" alt="$\sigma ^2$" style="vertical-align:0px; 
                                     width:16px; 
                                     height:14px" class="math gen" />の事後分布をリープフロッグで更新しようとしても、標準正規分布から発生させた乱数では1ステップあたりの遷移が（データの単位に比べて）少なすぎるため更新がほとんど進まない。</li><li id="a0000000065"><img src="images/img-0075.png" alt="$L$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />はリープフロッグ法の遷移時間。</li>
</ol>
</div>

<div class="navigation">
<div class="online-navigation">
<hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="4 メトロポリス・ヘイスティングス法" href="sect0001.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="基礎からのベイズ統計学" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="正規分布に関する推測" href="sect0003.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">基礎からのベイズ統計学</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0001.html" class="sectref" rel="prev">メトロポリス・ヘイスティングス法</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">基礎からのベイズ統計学</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0003.html" class="sectref" rel="next">正規分布に関する推測</a></span>
</div>
</div>
<hr />
<!--
<span class="release-info">Release 2.4.3, documentation updated on 29 March 2006.</span>
-->
</div>
<!--End of Navigation Panel-->
<!--
<address>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</address>
-->
</body>
</html>