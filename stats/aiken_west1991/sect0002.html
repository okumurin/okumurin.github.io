<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="shortcut icon" href="icons/pyfav.png" type="image/png" />
<link href="index.html" title="Multiple Regression: Testing and Interpreting Interactions" rel="start" />
<link href="index.html" title="Multiple Regression: Testing and Interpreting Interactions" rel="first" />
<link href="index.html" rel="contents" title="Contents" />
<link rel="index" title="Index" />
<link href="sect0003.html" rel="next" />
<link href="sect0001.html" rel="prev" />
<link href="index.html" rel="parent" />
<meta name="aesop" content="information" />
<title>2 独立変数のスケーリングと回帰係数</title>
</head>
<body>
<div class="navigation">
<div id="top-navigation-panel" xml:id="top-navigation-panel">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="1 連続変数間の交互作用" href="sect0001.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="Multiple Regression: Testing and Interpreting Interactions" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="3変数の交互作用" href="sect0003.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">Multiple Regression: Testing and Interpreting Interactions</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0001.html" class="sectref" rel="prev">連続変数間の交互作用</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">Multiple Regression: Testing and Interpreting Interactions</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0003.html" class="sectref" rel="next">3変数の交互作用</a></span>
</div>
<hr /></div>
</div>



<div><h1 id="a0000000003">2 独立変数のスケーリングと回帰係数</h1>
<p>交互作用項があると、変数のスケーリングで回帰係数の値は大きく変わる。 </p><ol class="enumerate">
<li value="1"><p>最高次の項以外が変化する </p></li><li value="2"><p><img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />と<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />を変換しても、単純傾斜<img src="images/img-0056.png" alt="$b_1+b_3Z$" style="vertical-align:-3px; 
                                     width:61px; 
                                     height:14px" class="math gen" />は変化しない </p></li><li value="3"><p>回帰式自体は変化しても、ordinal / disordinal は変化しない </p></li>
</ol><h2 id="a0000000042">2.1 高次項の変化</h2>
<p>加算変換 </p><table id="a0000000043" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000044">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0057.png" alt="$\displaystyle  X = X’-c  $" style="vertical-align:0px; width:84px; 
                   height:14px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.18</span>)</span></td>
</tr><tr id="a0000000045">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0058.png" alt="$\displaystyle Z= Z’ -f  $" style="vertical-align:-3px; width:80px; 
                   height:17px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.19</span>)</span></td>
</tr>
</table><p> により、 </p><table id="a0000000046" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000047">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0001.png" alt="$\displaystyle  \hat{Y}  $" style="vertical-align:0px; width:13px; 
                   height:17px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0002.png" alt="$\displaystyle = b_1 X + b_2 Z + b_3 X Z + b_0  $" style="vertical-align:-3px; width:189px; 
                   height:14px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.20</span>)</span></td>
</tr><tr id="a0000000048">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0059.png" alt="$\displaystyle = b_1 (X’-c) + b_2 (Z’-f) + b_3 (X’-c)(Z’-f) + b_0  $" style="vertical-align:-4px; width:375px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.21</span>)</span></td>
</tr><tr id="a0000000049">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0060.png" alt="$\displaystyle = (b_1 - b_3 f) X’ + (b_2 -b_3 c) Z’ + b3 X’ Z’ + (b_0 - b_1 c - b_2 f + b_3 cf)  $" style="vertical-align:-4px; width:473px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.22</span>)</span></td>
</tr><tr id="a0000000050">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0061.png" alt="$\displaystyle = b_1’ X’ + b_2’ Z’ + b_3 X’ Z’ + b_0’  $" style="vertical-align:-4px; width:208px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.23</span>)</span></td>
</tr>
</table><p> と変形できることがわかる。 つまり、交互作用項<img src="images/img-0040.png" alt="$b_3$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" />のみが変化しない。 </p><h2 id="a0000000051">2.2 単純回帰式の単純傾斜</h2>
<p>加算変換 </p><table id="a0000000052" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000053">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0057.png" alt="$\displaystyle  X = X’-c  $" style="vertical-align:0px; width:84px; 
                   height:14px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.24</span>)</span></td>
</tr><tr id="a0000000054">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0058.png" alt="$\displaystyle Z= Z’ -f  $" style="vertical-align:-3px; width:80px; 
                   height:17px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.25</span>)</span></td>
</tr>
</table><p> により、 </p><table id="a0000000055" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000056">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0001.png" alt="$\displaystyle  \hat{Y}  $" style="vertical-align:0px; width:13px; 
                   height:17px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0062.png" alt="$\displaystyle = (b_1 + b_3 Z) X + (b_2 Z + b_0)  $" style="vertical-align:-4px; width:200px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.26</span>)</span></td>
</tr><tr id="a0000000057">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0063.png" alt="$\displaystyle = [b_1 + b_3 (Z’-f)] (X’-c) + [b_2 (Z’-f) + b_0]  $" style="vertical-align:-5px; width:333px; 
                   height:19px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.27</span>)</span></td>
</tr><tr id="a0000000058">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0064.png" alt="$\displaystyle = [b_1 + b_3 (Z’-f)] X’ + [-b_1 c+ b_2 (Z’-f) - b_3 c(Z’-f) + b_0]  $" style="vertical-align:-5px; width:450px; 
                   height:19px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.28</span>)</span></td>
</tr><tr id="a0000000059">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0065.png" alt="$\displaystyle = (b_1 + b_3 Z) X’ + (-b_1 c + b_2 Z - b_3 c Z + b_0)  $" style="vertical-align:-4px; width:314px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.29</span>)</span></td>
</tr>
</table><p> と変形できることがわかる。 つまり、単純傾斜は加算変換により変化しない。 </p><h2 id="a0000000060">2.3 交差点</h2>
<p><img src="images/img-0066.png" alt="$b_2’=b_2-b_3 c$" style="vertical-align:-4px; 
                                     width:93px; 
                                     height:17px" class="math gen" />より、 </p><table id="a0000000061" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0067.png" alt="\begin{equation}  X’_{cross} = -\frac{b_2'}{b_3'} = -\frac{b_2-b_3 c}{b_3} = -\frac{b2}{b3} + c \end{equation}" style="width:277px; 
                            height:41px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.30</span>)</span></td>
</tr>
</table><p> となる。 <img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />の加算変換と同じく<img src="images/img-0047.png" alt="$X_{cross}$" style="vertical-align:-3px; 
                                     width:45px; 
                                     height:14px" class="math gen" />も移動する。 </p><h2 id="a0000000062">2.4 <img src="images/img-0006.png" alt="$Y$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />はセンタリングすべきか？</h2>
<p><img src="images/img-0006.png" alt="$Y$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />についてはセンタリングせずにもとのスケールで評価できるのであるから、センタリングする理由は特にない。 </p><h2 id="a0000000063">2.5 多重共線性</h2>
<p><img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />と<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />がセンタリングされていないと、<img src="images/img-0068.png" alt="$XZ$" style="vertical-align:0px; 
                                     width:27px; 
                                     height:11px" class="math gen" />や<img src="images/img-0069.png" alt="$X^2$" style="vertical-align:0px; 
                                     width:21px; 
                                     height:14px" class="math gen" />と高い相関を持つ。 </p><ul class="itemize">
<li><p><img src="images/img-0070.png" alt="$(X, Z)$" style="vertical-align:-4px; 
                                     width:44px; 
                                     height:18px" class="math gen" />と<img src="images/img-0068.png" alt="$XZ$" style="vertical-align:0px; 
                                     width:27px; 
                                     height:11px" class="math gen" />の相関 </p></li><li><p><img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />と<img src="images/img-0069.png" alt="$X^2$" style="vertical-align:0px; 
                                     width:21px; 
                                     height:14px" class="math gen" />の相関 </p></li>
</ul><p> は、センタリングしてあれば正規性の下ではゼロになる<a href="#a0000000064" class="footnote"><sup class="footnotemark">1</sup></a>。 </p><p>センタリングを怠ることで生じる多重共線性のことを、<b class="bfseries">非本質的な悪条件化 nonessential ill-conditioning</b>と呼ぶ<a href="#a0000000065" class="footnote"><sup class="footnotemark">2</sup></a>。 </p><h2 id="a0000000066">2.6 交互作用<img src="images/img-0068.png" alt="$XZ$" style="vertical-align:0px; 
                                     width:27px; 
                                     height:11px" class="math gen" />項の解釈</h2>
<p><img src="images/img-0006.png" alt="$Y$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />の<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />への回帰と考えた場合、<img src="images/img-0068.png" alt="$XZ$" style="vertical-align:0px; 
                                     width:27px; 
                                     height:11px" class="math gen" />にかかる係数<img src="images/img-0040.png" alt="$b_3$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" />は<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />の1ポイントの増加に対応する<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />の傾きの増分である。 </p><h2 id="a0000000067">2.7 <img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />と<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />の1次の項の解釈</h2>
<p>センタリングがなされていれば、<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />にかかる係数<img src="images/img-0007.png" alt="$b_1$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" />は<img src="images/img-0071.png" alt="$Z=Z_ M$" style="vertical-align:-3px; 
                                     width:57px; 
                                     height:14px" class="math gen" />の場合の傾きの大きさである。 </p><p><img src="images/img-0007.png" alt="$b_1$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" />や<img src="images/img-0072.png" alt="$b_2$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" />は<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />や<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />の主効果ではない。 主効果は他の変数の取りうる値について平均化した効果。 </p><h2 id="a0000000068">2.8 標準化解</h2>
<p>一般に、 </p><table id="a0000000069" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000070">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0073.png" alt="$\displaystyle  z_{X'Z'} \neq z_{X'} z_{Z'}  $" style="vertical-align:-4px; width:106px; 
                   height:16px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.31</span>)</span></td>
</tr><tr id="a0000000071">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0074.png" alt="$\displaystyle z_{XZ} \neq z_{X} z_{Z}  $" style="vertical-align:-4px; width:90px; 
                   height:16px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.32</span>)</span></td>
</tr>
</table><p> であるから、積項自体を標準化するのではなく、標準化した変数の積を用いた分析結果を「標準化解」として報告するべき<a href="#a0000000072" class="footnote"><sup class="footnotemark">3</sup></a>。 </p><p>この場合、通常の標準化解と異なり切片<img src="images/img-0075.png" alt="$b_0$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" />はゼロとはならない。 </p><ul class="itemize">
<li><p><img src="images/img-0076.png" alt="$\bar{z}_{X}=0, \bar{z}_{Z}=0$" style="vertical-align:-3px; 
                                     width:106px; 
                                     height:15px" class="math gen" />でも<img src="images/img-0077.png" alt="$\bar{z}_{XZ}=0$" style="vertical-align:-3px; 
                                     width:60px; 
                                     height:15px" class="math gen" />とは限らない </p></li><li><p><img src="images/img-0078.png" alt="$z_{X} z_{Z}$" style="vertical-align:-3px; 
                                     width:38px; 
                                     height:10px" class="math gen" />の平均は<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />と<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />の相関に等しい </p></li><li><p>もし<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />と<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />が無相関なら<img src="images/img-0078.png" alt="$z_{X} z_{Z}$" style="vertical-align:-3px; 
                                     width:38px; 
                                     height:10px" class="math gen" />の </p><ul class="itemize">
<li><p>平均=0 </p></li><li><p>SD=1 </p></li>
</ul><p> となる </p></li>
</ul><h2 id="a0000000073">2.9 標準化解と非標準化解の関係</h2>
<table id="a0000000074" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000075">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0079.png" alt="$\displaystyle  b_ i^* = b_ i \frac{s_ i}{s_ Y}  $" style="vertical-align:-14px; width:71px; 
                   height:32px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.33</span>)</span></td>
</tr><tr id="a0000000076">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0080.png" alt="$\displaystyle b_0^* = \frac{b_0-\bar{Y}}{s_ Y}  $" style="vertical-align:-13px; width:88px; 
                   height:40px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.34</span>)</span></td>
</tr><tr id="a0000000077">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0081.png" alt="$\displaystyle \mathrm{Cov}[b_ i^* b_ j^*] = \mathrm{Cov}[b_ i b_ j] \frac{s_ i s_ j}{s_ Y^2}  $" style="vertical-align:-16px; width:184px; 
                   height:34px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.35</span>)</span></td>
</tr><tr id="a0000000078">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0082.png" alt="$\displaystyle s^*_ b = s_ b \frac{s_ i}{s_ Y}  $" style="vertical-align:-14px; width:74px; 
                   height:32px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.36</span>)</span></td>
</tr>
</table><h2 id="a0000000079">2.10 分析例</h2>
<p>Rのデータ <tt class="ttfamily">attitude</tt> を用いて、ここまでの分析を実行してみる。 </p><p><tt class="ttfamily">attitude</tt>を以下のように加工。 </p><p><small class="small"><pre>
&gt; data(attitude)
&gt; 
&gt; attach(attitude)
&gt; data01 &lt;- data.frame(y=rating, x=complaints, z=privileges)
&gt; detach(attitude)
&gt; 
&gt; data01 &lt;- data.frame(scale(data01, scale=F)) # センタリングのみ
&gt; data02 &lt;- data.frame(scale(data01))          # 標準化
&gt; 
&gt; data01$xz &lt;- data01$x * data01$z # センタリング変数の積
&gt; data02$xz &lt;- data02$x * data02$z # 標準化変数の積
&gt; 
&gt; head(data01, n=5)
           y     x          z         xz
1 -21.633333 -15.6 -23.133333 360.880000
2  -1.633333  -2.6  -2.133333   5.546667
3   6.366667   3.4  14.866667  50.546667
4  -3.633333  -3.6  -8.133333  29.280000
5  16.366667  11.4   2.866667  32.680000
&gt; head(data02, n=5)
           y          x          z         xz
1 -1.7772211 -1.1716323 -1.8906841 2.21518666
2 -0.1341816 -0.1952721 -0.1743570 0.03404706
3  0.5230342  0.2553558  1.2150506 0.31027018
4 -0.2984855 -0.2703767 -0.6647362 0.17972918
5  1.3445540  0.8561929  0.2342923 0.20059937
&gt; 
&gt; cor(data01)
            y          x          z          xz
y   1.0000000  0.8254176 0.42611687 -0.25268076
x   0.8254176  1.0000000 0.55828820 -0.18464516
z   0.4261169  0.5582882 1.00000000  0.08644766
xz -0.2526808 -0.1846452 0.08644766  1.00000000
</pre> </small> </p><p><span class="normalsize"><p><tt class="ttfamily">data01</tt>が非標準化、<tt class="ttfamily">data02</tt>が標準化したデータ。 </p><p>非標準化解と標準化解はそれぞれ以下の通り。 </p><p><small class="small"><pre>
&gt; fit01 &lt;- lm(y~x+z+xz, data=data01); summary(fit01) # 非標準化解

Call:
lm(formula = y ~ x + z + xz, data = data01)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.3067  -4.9662  -0.5419   6.6579   8.9681 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.602946   1.474594   0.409    0.686    
x            0.749631   0.124986   5.998 2.48e-06 ***
z           -0.022962   0.134175  -0.171    0.865    
xz          -0.006858   0.007864  -0.872    0.391    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.134 on 26 degrees of freedom
Multiple R-squared:  0.6921,	Adjusted R-squared:  0.6565 
F-statistic: 19.48 on 3 and 26 DF,  p-value: 7.913e-07

&gt; fit02 &lt;- lm(y~x+z+xz, data=data02); summary(fit02) # 標準化解

Call:
lm(formula = y ~ x + z + xz, data = data02)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.09317 -0.40798 -0.04452  0.54696  0.73675 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.04953    0.12114   0.409    0.686    
x            0.81997    0.13671   5.998 2.48e-06 ***
z           -0.02308    0.13487  -0.171    0.865    
xz          -0.09178    0.10525  -0.872    0.391    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.5861 on 26 degrees of freedom
Multiple R-squared:  0.6921,	Adjusted R-squared:  0.6565 
F-statistic: 19.48 on 3 and 26 DF,  p-value: 7.913e-07
</pre> </small> </p><p><span class="normalsize"><p>検定結果は全く同じ。 </p><p>非標準解について、<img src="images/img-0011.png" alt="$Z_ L, Z_ M, Z_ H$" style="vertical-align:-3px; 
                                     width:83px; 
                                     height:14px" class="math gen" />における単純回帰直線の傾き（単純傾斜）と切片、<img src="images/img-0006.png" alt="$Y$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />の予測値、単純回帰直線の交差する<img src="images/img-0005.png" alt="$X$" style="vertical-align:0px; 
                                     width:14px; 
                                     height:11px" class="math gen" />の値を求める。 </p><p><small class="small"><pre>
&gt; coef01 &lt;- fit01$coefficients
&gt; zm &lt;- mean(data01$z)    # zの平均 (=0)
&gt; zl &lt;- zm - sd(data01$z) # zの平均-1SD
&gt; zh &lt;- zm + sd(data01$z) # zの平均+1sd
&gt; vec.z &lt;- c(zl,zm,zh)
&gt; vec.slope &lt;- coef01[2] + coef01[4]*vec.z; vec.slope # 単純傾斜
[1] 0.8335401 0.7496309 0.6657216
&gt; vec.itcpt &lt;- coef01[1] + coef01[3]*vec.z; vec.itcpt # 単純切片？
[1] 0.8838989 0.6029459 0.3219930
&gt; vec.x &lt;- seq(from=min(data01$x),to=max(data01$x),by=1) # xの範囲
&gt; vec.yhat &lt;- cbind(vec.slope[1]*vec.x+vec.itcpt[1], 
+                   vec.slope[2]*vec.x+vec.itcpt[2], 
+                   vec.slope[3]*vec.x+vec.itcpt[3]) # yhat
&gt; xcross &lt;- -coef01[3]/coef01[4]; xcross # 単純回帰直線の交差点
        z 
-3.348295 
</pre> </small> </p><p><span class="normalsize"><p>この単純回帰直線を図示したのが図<a href="sect0002.html#fig161028simpleslope01">2.1</a>。 交差点は<img src="images/img-0083.png" alt="$X_{cross}=-3.348$" style="vertical-align:-3px; 
                                     width:118px; 
                                     height:15px" class="math gen" />。 </p><div id="fig161028simpleslope01" class="figure"><center> 
<img src="images/img-0084.png" alt="\includegraphics[width=8cm]{fig161028simpleslope01.png}" style="width:8cm" /> <div class="caption"><b>Figure 2.1</b>: <span>単純回帰直線</span></div>  </center></div><p><img src="images/img-0085.png" alt="$H_0: \textit{Simple Slope} =0$" style="vertical-align:-3px; 
                                     width:157px; 
                                     height:15px" class="math gen" />の検定を行う。（方法1） </p><p><small class="small"><pre>
&gt; # H0: 単純傾斜=0 の検定（方法1）
&gt; mat.v &lt;- vcov(fit01) # 回帰係数の分散共分散行列
&gt; vec.seb &lt;- sqrt(mat.v[2,2]+2*vec.z*mat.v[2,4]+vec.z^2*mat.v[4,4]) # bのSE
&gt; vec.t &lt;- vec.slope/vec.seb; vec.t # t値
[1] 6.195257 5.997740 3.741559
&gt; df.t &lt;- dim(data01)[1]-3-1; df.t   # 自由度
[1] 26
&gt; pt(q=vec.t,df=df.t,lower.tail=F)*2 # 両側p値
[1] 1.490762e-06 2.476360e-06 9.139201e-04
&gt; 
&gt; # 単純傾斜のSE
&gt; MS &lt;- sum(fit01$residuals^2)/df.t; MS # 残差平均平方
[1] 50.89091
&gt; XX &lt;- t(as.matrix(cbind(1,data01[,-1]))) %*% as.matrix(cbind(1,data01[,-1]))
&gt; Sb &lt;- MS * solve(XX)[-1,-1]; Sb     # 回帰係数の分散共分散行列
               x             z            xz
x   0.0156213878 -0.0098354140  2.769709e-04
z  -0.0098354140  0.0180028116 -2.452723e-04
xz  0.0002769709 -0.0002452723  6.184569e-05
&gt; mat.w &lt;- matrix(c(1,0,zl, 1,0,zm, 1,0,zh), 3, 3); mat.w # 重み行列
          [,1]         [,2]     [,3]
[1,]   1.00000 1.000000e+00  1.00000
[2,]   0.00000 0.000000e+00  0.00000
[3,] -12.23543 4.738108e-16 12.23543
&gt; vec.seb &lt;-sqrt(c(t(mat.w[,1]) %*% Sb %*% mat.w[,1],
+                  t(mat.w[,2]) %*% Sb %*% mat.w[,2],
+                  t(mat.w[,3]) %*% Sb %*% mat.w[,3])); vec.seb # 単純傾斜のSE
[1] 0.1345449 0.1249856 0.1779263
</pre> </small> <span class="normalsize"><blockquote class="quote"><p> <span style="border: 1px solid black"><b class="bfseries">メモ</b></span> </p><p><img src="images/img-0086.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {b}$" style="vertical-align:0px; 
                                     width:7px; 
                                     height:11px" class="math gen" />の分散共分散行列<img src="images/img-0022.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {\Sigma }_{b}$" style="vertical-align:-3px; 
                                     width:17px; 
                                     height:14px" class="math gen" />は </p><table id="a0000000080" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0023.png" alt="\begin{equation}  \bm@general \boldmath \m@ne \mv@bold \bm@command {S}_ b = MS_{Y-\hat{Y}} \bm@general \boldmath \m@ne \mv@bold \bm@command {S}_{XX}^{-1} \end{equation}" style="width:135px; 
                            height:22px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.37</span>)</span></td>
</tr>
</table><p> で推定するとされていたが、<img src="images/img-0053.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {S}_{XX}$" style="vertical-align:-3px; 
                                     width:33px; 
                                     height:14px" class="math gen" />を本書にあるように独立変数の分散共分散行列とすると、<tt class="ttfamily">vcov()</tt>を用いて算出した結果と一致しない。 同じ結果にするには、<img src="images/img-0053.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {S}_{XX}$" style="vertical-align:-3px; 
                                     width:33px; 
                                     height:14px" class="math gen" />を<img src="images/img-0054.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {X}’\bm@general \boldmath \m@ne \mv@bold \bm@command {X}$" style="vertical-align:0px; 
                                     width:35px; 
                                     height:14px" class="math gen" />とする必要がある。 つまり、 </p><table id="a0000000081" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000082">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0087.png" alt="$\displaystyle  \bm@general \boldmath \m@ne \mv@bold \bm@command {S}_ b  $" style="vertical-align:-3px; width:17px; 
                   height:14px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0088.png" alt="$\displaystyle = MS_{Y-\hat{Y}} (\bm@general \boldmath \m@ne \mv@bold \bm@command {X}’\bm@general \boldmath \m@ne \mv@bold \bm@command {X})^{-1} = \hat{\sigma }^2 (\bm@general \boldmath \m@ne \mv@bold \bm@command {X}’\bm@general \boldmath \m@ne \mv@bold \bm@command {X})^{-1}  $" style="vertical-align:-6px; width:248px; 
                   height:21px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.38</span>)</span></td>
</tr><tr id="a0000000083">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0003.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0089.png" alt="$\displaystyle = \frac{1}{n-k-1} \sum _{i=1}^ n (y_ i-\hat{y})^2 \times (\bm@general \boldmath \m@ne \mv@bold \bm@command {X}’\bm@general \boldmath \m@ne \mv@bold \bm@command {X})^{-1}  $" style="vertical-align:-20px; width:263px; 
                   height:46px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.39</span>)</span></td>
</tr>
</table><p> ということ。 </p><div style="text-align:right"> <span style="border: 1px solid black"><b class="bfseries">メモここまで</b></span> </div></blockquote><p><img src="images/img-0090.png" alt="$H_0: \textit{Simple Slope}=0$" style="vertical-align:-3px; 
                                     width:157px; 
                                     height:15px" class="math gen" />の検定を行う。（方法2） </p><p><small class="small"><pre>
&gt; # H0: 単純傾斜=0 の検定（方法2）
&gt; v.zcv &lt;- data.frame(zcvl=data01$z-zl, zcvm=data01$z-zm, zcvh=data01$z-zh)
&gt; v.xzcv &lt;- v.zcv * data01$x; names(v.xzcv) &lt;- c("xzcvl","xzcvm","xzcvh")
&gt; data01cv &lt;- cbind(data01, v.zcv, v.xzcv)
&gt; fit01.cvl &lt;- lm(y~x+zcvl+xzcvl, data=data01cv); summary(fit01.cvl)
...省略...
Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
x            0.833540   0.134545   6.195 1.49e-06 ***

...省略...

&gt; fit01.cvm &lt;- lm(y~x+zcvm+xzcvm, data=data01cv); summary(fit01.cvm)
Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
x            0.749631   0.124986   5.998 2.48e-06 ***
...省略...

&gt; fit01.cvh &lt;- lm(y~x+zcvh+xzcvh, data=data01cv); summary(fit01.cvh)
...省略...  
x            0.665722   0.177926   3.742 0.000914 ***
...省略...
</pre> </small> <span class="normalsize"><p>単純傾斜のSEを用いる方法（方法1）でも、<img src="images/img-0009.png" alt="$Z$" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />の加算変換による方法（方法2）でも、同じ結果が得られていることがわかる。 </p></span></p></span></p></span></p></span></p></span></p></div>

<div id="footnotes">
<p><b>Footnotes</b></p>
<ol>
<li id="a0000000064">センタリングしてあるのに相関がゼロでないのは、非正規性による。</li><li id="a0000000065">Marquardt (1980)</li><li id="a0000000072">Friedrich (1982)</li>
</ol>
</div>

<div class="navigation">
<div class="online-navigation">
<hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="1 連続変数間の交互作用" href="sect0001.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="Multiple Regression: Testing and Interpreting Interactions" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="3変数の交互作用" href="sect0003.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">Multiple Regression: Testing and Interpreting Interactions</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0001.html" class="sectref" rel="prev">連続変数間の交互作用</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">Multiple Regression: Testing and Interpreting Interactions</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0003.html" class="sectref" rel="next">3変数の交互作用</a></span>
</div>
</div>
<hr />
<!--
<span class="release-info">Release 2.4.3, documentation updated on 29 March 2006.</span>
-->
</div>
<!--End of Navigation Panel-->
<!--
<address>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</address>
-->
</body>
</html>