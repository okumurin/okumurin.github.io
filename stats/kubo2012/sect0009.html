<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="shortcut icon" href="icons/pyfav.png" type="image/png" />
<link href="index.html" title="データ解析のための統計モデリング入門" rel="start" />
<link href="index.html" title="データ解析のための統計モデリング入門" rel="first" />
<link href="index.html" rel="contents" title="Contents" />
<link rel="index" title="Index" />
<link href="sect0010.html" rel="next" />
<link href="sect0008.html" rel="prev" />
<link href="index.html" rel="parent" />
<meta name="aesop" content="information" />
<title>9 GLMのベイズモデル化と事後分布の推定</title>
</head>
<body>
<div class="navigation">
<div id="top-navigation-panel" xml:id="top-navigation-panel">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="8 マルコフ連鎖モンテカルロ法とベイズ統計モデル" href="sect0008.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="データ解析のための統計モデリング入門" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="階層ベイズモデル" href="sect0010.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">データ解析のための統計モデリング入門</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0008.html" class="sectref" rel="prev">マルコフ連鎖モンテカルロ法とベイズ統計モデル</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">データ解析のための統計モデリング入門</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0010.html" class="sectref" rel="next">階層ベイズモデル</a></span>
</div>
<hr /></div>
</div>



<div><h1 id="a0000000010">9 GLMのベイズモデル化と事後分布の推定</h1>
<h2 id="a0000000121">9.2 GLMのベイズモデル化</h2>
<p>個体 <img src="images/img-0069.png" alt="$i$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" /> の種子数 <img src="images/img-0071.png" alt="$y_ i$" style="vertical-align:-3px; 
                                     width:12px; 
                                     height:10px" class="math gen" /> が平均 <img src="images/img-0013.png" alt="$\lambda _ i$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:14px" class="math gen" /> のポアソン分布に従うとする。 この平均は、体サイズ <img src="images/img-0012.png" alt="$x_ i$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:10px" class="math gen" /> を用いて <img src="images/img-0112.png" alt="$\lambda _ i = \exp (\beta _1 + \beta _2 x_ i)$" style="vertical-align:-4px; 
                                     width:142px; 
                                     height:18px" class="math gen" /> とする。 </p><p>事後分布は、 </p><table id="a0000000122" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0113.png" alt="\begin{equation}  p(\beta _1, \beta _2 \mid \bm@general \boldmath \m@ne \mv@bold \bm@command {Y}) \propto p(\bm@general \boldmath \m@ne \mv@bold \bm@command {Y} \mid \beta _1, \beta _2) p(\beta _1) p(\beta _2) \end{equation}" style="width:279px; 
                            height:18px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>9.40</span>)</span></td>
</tr>
</table><p> となる。 </p><h2 id="a0000000123">9.3 無情報事前分布</h2>
<p> 無限区間の一様分布は積分しても1にならないので、例えば </p><ul class="itemize">
<li><p><img src="images/img-0114.png" alt="$-10^9 &lt; \beta _* &lt; 10^9$" style="vertical-align:-3px; 
                                     width:119px; 
                                     height:17px" class="math gen" /> の一様分布 </p></li><li><p>平均ゼロで標準偏差がとても大きい平たい正規分布 </p></li>
</ul><p> のいずれかを無情報的な事前分布として指定することを考える。 以降は、「平べったい正規分布」を利用する。 </p><h2 id="a0000000124">9.4 ベイズ統計モデルの事後分布の推定</h2>
<h4 id="a0000000125">BUGSのコード</h4>
<blockquote class="quote"> <small class="small"><pre>
model{
  for(i in 1:N){
      y[i] ~ dpois(lambda[i]) # 種子数は平均lambda[i]のポアソン分布に従う
      log(lambda[i]) &lt;- beta1 + beta2 * (X[i]-Mean.X) # 対数リンク関数（X[i]は高速化のため中心化）       }
  beta1 ~ dnorm(0,1.0E-4) # 事前分布（dnorm(mean, tau) で tau は分散の逆数）
  beta2 ~ dnorm(0,1.0E-4) # 事前分布
}
</pre> </small> </blockquote><blockquote class="quote"><p> <span style="border: 1px solid black"><b class="bfseries">メモ</b></span> </p><p><img src="images/img-0012.png" alt="$x_ i$" style="vertical-align:-3px; 
                                     width:13px; 
                                     height:10px" class="math gen" /> を中心化すると（標準化もすると）MCMCが高速化する、という理由がよくわからない。 </p><p>また、本文中では中心化の前後で結果は本質的に同じであるとされているが、切片の値は本質的に変わるはず。 </p><div style="text-align:right"> <span style="border: 1px solid black"><b class="bfseries">メモここまで</b></span> </div></blockquote><h4 id="a0000000126">RでWinBUGSを操作する</h4>
<p>Rの <tt class="ttfamily">R2WinBUGS</tt> パッケージ を用いて、データ・初期値・MCMCサンプリングの回数・BUGSコードファイル名などをRからWinBUGSに渡してやり、結果をRに渡してもらう。 </p><h3 id="a0000000127">9.4.3 どれだけ長くMCMCサンプリングすればいいのか？</h3>
<p>初期値の異なる複数のサンプリング（サンプル列 : chain）を比較することが有用。 </p><p>サンプル列が3本以上ある場合、<img src="images/img-0115.png" alt="$\hat{R}$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:17px" class="math gen" /> が<b class="bfseries">収束診断</b>の指標として用いられる。 サンプル列ごとの分散の平均を<img src="images/img-0116.png" alt="$W$" style="vertical-align:0px; 
                                     width:17px; 
                                     height:11px" class="math gen" />、周辺事後分布の分散を </p><table id="a0000000128" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0117.png" alt="\begin{equation}  \widehat{\text {var}}^+ = \frac{n-1}{n} W + \frac{1}{n} B \end{equation}" style="width:163px; 
                            height:34px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>9.41</span>)</span></td>
</tr>
</table><p> として、 </p><table id="a0000000129" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0118.png" alt="\begin{equation}  \hat{R} = \sqrt{\frac{\widehat{\text {var}}^+}{W}} \end{equation}" style="width:90px; 
                            height:50px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>9.42</span>)</span></td>
</tr>
</table><p> と定義する。 </p><h2 id="a0000000130">9.6 複数パラメータのMCMCサンプリング</h2>
<p>複数パラメータを同時に更新するのは簡単ではないので、<img src="images/img-0119.png" alt="$\beta _1$" style="vertical-align:-3px; 
                                     width:15px; 
                                     height:14px" class="math gen" /> と <img src="images/img-0120.png" alt="$\beta _2$" style="vertical-align:-3px; 
                                     width:15px; 
                                     height:14px" class="math gen" /> を交互に更新することを考える。 </p><h3 id="a0000000131">9.6.1 ギブスサンプリング</h3>
<p><b class="bfseries">全条件付き分布（FCD）</b><a href="#a0000000132" class="footnote"><sup class="footnotemark">1</sup></a>からのランダムサンプルを利用する。 </p><ul class="itemize">
<li><p>各MCMCステップにおいてもとの値と更新された値の相関がより小さい </p></li><li><p>MCMCサンプリングの詳細を指定しなくても良い<a href="#a0000000133" class="footnote"><sup class="footnotemark">2</sup></a> </p></li>
</ul></div>

<div id="footnotes">
<p><b>Footnotes</b></p>
<ol>
<li id="a0000000132">他の変量全てを定数とする一変量確率分布</li><li id="a0000000133">？</li>
</ol>
</div>

<div class="navigation">
<div class="online-navigation">
<hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="8 マルコフ連鎖モンテカルロ法とベイズ統計モデル" href="sect0008.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="データ解析のための統計モデリング入門" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="階層ベイズモデル" href="sect0010.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">データ解析のための統計モデリング入門</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0008.html" class="sectref" rel="prev">マルコフ連鎖モンテカルロ法とベイズ統計モデル</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">データ解析のための統計モデリング入門</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0010.html" class="sectref" rel="next">階層ベイズモデル</a></span>
</div>
</div>
<hr />
<!--
<span class="release-info">Release 2.4.3, documentation updated on 29 March 2006.</span>
-->
</div>
<!--End of Navigation Panel-->
<!--
<address>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</address>
-->
</body>
</html>