<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="shortcut icon" href="icons/pyfav.png" type="image/png" />
<link href="index.html" title="データ解析のための統計モデリング入門" rel="start" />
<link href="index.html" title="データ解析のための統計モデリング入門" rel="first" />
<link href="index.html" rel="contents" title="Contents" />
<link rel="index" title="Index" />
<link href="sect0005.html" rel="next" />
<link href="sect0003.html" rel="prev" />
<link href="index.html" rel="parent" />
<meta name="aesop" content="information" />
<title>4 GLMのモデル選択</title>
</head>
<body>
<div class="navigation">
<div id="top-navigation-panel" xml:id="top-navigation-panel">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="3 一般化線形モデル（GLM）" href="sect0003.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="データ解析のための統計モデリング入門" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="GLMの尤度比検定と検定の非対称性" href="sect0005.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">データ解析のための統計モデリング入門</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0003.html" class="sectref" rel="prev">一般化線形モデル（GLM）</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">データ解析のための統計モデリング入門</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0005.html" class="sectref" rel="next">GLMの尤度比検定と検定の非対称性</a></span>
</div>
<hr /></div>
</div>



<div><h1 id="a0000000005">4 GLMのモデル選択</h1>
<h2 id="a0000000035">4.1 データはひとつ、モデルはたくさん</h2>
<p>「<b class="bfseries">最大対数尤度</b> <img src="images/img-0018.png" alt="$=$" style="vertical-align:2px; 
                                     width:11px; 
                                     height:4px" class="math gen" /> モデルの良さ」か？（そうではない。） </p><h2 id="a0000000036">4.2 統計モデルのあてはまりの悪さ：逸脱度</h2>
<h4 id="a0000000037">逸脱度（deviance）</h4>
<p>最大対数尤度を <img src="images/img-0019.png" alt="$\log L^*$" style="vertical-align:-3px; 
                                     width:41px; 
                                     height:16px" class="math gen" /> として、 </p><table id="a0000000038" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0020.png" alt="\begin{equation*}  D = -2 \log L^* \end{equation*}" style="width:102px; 
                            height:16px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%">&nbsp;</td>
</tr>
</table><p>逸脱度は、フルモデルを当てはめた時に最小値、ゼロモデルを当てはめたときに最大値をとる。 そこで、フルモデルの逸脱度を基準として、 </p><ul class="itemize">
<li><p><b class="bfseries">残差逸脱度（residual deviance）</b> <img src="images/img-0018.png" alt="$=$" style="vertical-align:2px; 
                                     width:11px; 
                                     height:4px" class="math gen" /> 逸脱度 <img src="images/img-0021.png" alt="$-$" style="vertical-align:4px; 
                                     width:11px; 
                                     height:1px" class="math gen" /> フルモデルの逸脱度 </p></li><li><p><b class="bfseries">ゼロ逸脱度（null deviance）</b> <img src="images/img-0018.png" alt="$=$" style="vertical-align:2px; 
                                     width:11px; 
                                     height:4px" class="math gen" /> ゼロモデルの逸脱度 <img src="images/img-0021.png" alt="$-$" style="vertical-align:4px; 
                                     width:11px; 
                                     height:1px" class="math gen" /> フルモデルの逸脱度 </p></li>
</ul><p> と定義する。 Rの <tt class="ttfamily">glm()</tt> では、これら2つが報告される。 </p><p>残差逸脱度は、パラメータ数 <img src="images/img-0022.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" /> さえ増やせばどんどん小さくなる（あてはまりが良くなる）。 </p><h2 id="a0000000039">4.3 モデル選択規準AIC</h2>
<p>当てはまりの良さではなく、<b class="bfseries">予測の良さ</b>を重視する。 </p><p>最大対数尤度を <img src="images/img-0019.png" alt="$\log L^*$" style="vertical-align:-3px; 
                                     width:41px; 
                                     height:16px" class="math gen" />、最尤推定したパラメータ数を <img src="images/img-0022.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" /> とすると、 </p><table id="a0000000040" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000041">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0023.png" alt="$\displaystyle  \text {AIC}  $" style="vertical-align:0px; width:29px; 
                   height:12px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0024.png" alt="$\displaystyle = -2 (\log L^* - k)  $" style="vertical-align:-4px; width:121px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.5</span>)</span></td>
</tr><tr id="a0000000042">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0025.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0026.png" alt="$\displaystyle = D + 2k  $" style="vertical-align:-2px; width:68px; 
                   height:14px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.6</span>)</span></td>
</tr>
</table><p> で定義される。 </p><h2 id="a0000000043">4.5 なぜAICでモデル選択して良いのか？</h2>
<h3 id="a0000000044">4.5.1 統計モデルの予測の良さ：平均対数尤度</h3>
<p>最大対数尤度は、推定された統計モデルがたまたま得られた観測データにどれくらい当てはまっているかを表す量。 </p><div id="fig0406" class="figure"><center> 
<img src="images/img-0027.png" alt="\includegraphics[width=15cm]{fig0406.png}" style="width:15cm" /> <div class="caption"><b>Figure 4.6</b>: <span>最大対数尤度</span></div>  </center></div><p>今、真の統計モデル（パラメータ <img src="images/img-0028.png" alt="$\theta $" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />）から大きさ <img src="images/img-0029.png" alt="$N$" style="vertical-align:0px; 
                                     width:15px; 
                                     height:11px" class="math gen" /> の標本が得られ、 </p><ul class="itemize">
<li><p>パラメータの推定値 <img src="images/img-0030.png" alt="$\hat{\theta }$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:17px" class="math gen" /> </p></li><li><p>最大対数尤度 <img src="images/img-0019.png" alt="$\log L^*$" style="vertical-align:-3px; 
                                     width:41px; 
                                     height:16px" class="math gen" /> </p></li>
</ul><p> が得られているとする。 仮に同じ手続きで大きさ <img src="images/img-0029.png" alt="$N$" style="vertical-align:0px; 
                                     width:15px; 
                                     height:11px" class="math gen" /> の標本が多数回抽出され、<img src="images/img-0031.png" alt="$\theta =\hat{\theta }$" style="vertical-align:0px; 
                                     width:38px; 
                                     height:17px" class="math gen" /> とした時の尤度を算出し、その平均（<b class="bfseries">平均対数尤度</b>：<img src="images/img-0032.png" alt="$E(\log L)$" style="vertical-align:-4px; 
                                     width:60px; 
                                     height:18px" class="math gen" />）を取ることができたとする。 このとき、最大対数尤度と平均対数尤度の差（<b class="bfseries">バイアス</b>） </p><table id="a0000000045" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0033.png" alt="\begin{equation}  b = \log L^* - E(\log L) \end{equation}" style="width:152px; 
                            height:18px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.7</span>)</span></td>
</tr>
</table><p> の分布を考えると<a href="#a0000000046" class="footnote"><sup class="footnotemark">1</sup></a>、<img src="images/img-0034.png" alt="$E(b)=k$" style="vertical-align:-4px; 
                                     width:64px; 
                                     height:18px" class="math gen" /> となることが知られている<a href="#a0000000047" class="footnote"><sup class="footnotemark">2</sup></a>。 </p><p>すると、データから計算された最大対数尤度とパラメータ数を用いて、平均対数尤度を </p><table id="a0000000048" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0035.png" alt="\begin{equation}  \widehat{E}(\log L) = \log L^* - k \end{equation}" style="width:156px; 
                            height:21px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.8</span>)</span></td>
</tr>
</table><p> と推定できる<a href="#a0000000049" class="footnote"><sup class="footnotemark">3</sup></a>。 これを<b class="bfseries">バイアス補正</b>と呼ぶ。 </p><p>つまり、 </p><table id="a0000000050" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0036.png" alt="\begin{equation}  \text {AIC}=-2 \widehat{E}(\log L) \end{equation}" style="width:134px; 
                            height:21px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.9</span>)</span></td>
</tr>
</table><p> ということ。 </p><p>ここで、パラメータ数 <img src="images/img-0022.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" /> のモデルに <img src="images/img-0037.png" alt="$l$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" /> 個のパラメータを追加したモデルを当てはめることを考える。 このとき、バイアスの期待値は </p><table id="a0000000051" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000052">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0038.png" alt="$\displaystyle  E(b_ k)  $" style="vertical-align:-4px; width:40px; 
                   height:18px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0039.png" alt="$\displaystyle = k  $" style="vertical-align:0px; width:25px; 
                   height:11px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.10</span>)</span></td>
</tr><tr id="a0000000053">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0040.png" alt="$\displaystyle E(b_{k+l})  $" style="vertical-align:-5px; width:54px; 
                   height:19px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0041.png" alt="$\displaystyle = k+l  $" style="vertical-align:-2px; width:51px; 
                   height:13px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.11</span>)</span></td>
</tr>
</table><p> となる。 つまり、パラメータを <img src="images/img-0037.png" alt="$l$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" /> 個追加することで、最大対数尤度と平均対数尤度の差は、平均で <img src="images/img-0037.png" alt="$l$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" /> 増加する。 </p><p>また、AICは </p><table id="a0000000054" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000055">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0042.png" alt="$\displaystyle  \text {AIC}_ k  $" style="vertical-align:-3px; width:37px; 
                   height:15px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0043.png" alt="$\displaystyle = -2 \widehat{E} (\log L_ k) = -2 ( \log L_ k^* - k ) $" style="vertical-align:-4px; width:235px; 
                   height:21px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.12</span>)</span></td>
</tr><tr id="a0000000056">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0044.png" alt="$\displaystyle \text {AIC}_{k+l}  $" style="vertical-align:-5px; width:51px; 
                   height:17px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0045.png" alt="$\displaystyle = -2 \widehat{E} (\log L_{k+l}) = -2 ( \log L_{k+l}^* - k-l)  $" style="vertical-align:-6px; width:290px; 
                   height:23px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.13</span>)</span></td>
</tr>
</table><p> なので、 </p><table id="a0000000057" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0046.png" alt="\begin{equation}  \text {AIC}_{k} - \text {AIC}_{k+l} = -2(\log L_ k^*-\log L_{k+1}^*+l) \end{equation}" style="width:317px; 
                            height:20px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>4.14</span>)</span></td>
</tr>
</table><p> より <img src="images/img-0047.png" alt="$\log L_{k+1}^*-\log L_{k}^* &gt; l$" style="vertical-align:-7px; 
                                     width:151px; 
                                     height:20px" class="math gen" /> なら <img src="images/img-0048.png" alt="$\text {AIC}_{k} &gt; \text {AIC}_{k+l}$" style="vertical-align:-5px; 
                                     width:112px; 
                                     height:17px" class="math gen" /> となる。 つまり、パラメータを <img src="images/img-0037.png" alt="$l$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" /> 加えることによる最大対数尤度の増分が <img src="images/img-0037.png" alt="$l$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" /> を上回るのであれば、AICは小さくなる。 </p></div>

<div id="footnotes">
<p><b>Footnotes</b></p>
<ol>
<li id="a0000000046"><img src="images/img-0049.png" alt="$b$" style="vertical-align:0px; 
                                     width:7px; 
                                     height:11px" class="math gen" />は <img src="images/img-0030.png" alt="$\hat{\theta }$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:17px" class="math gen" /> と <img src="images/img-0019.png" alt="$\log L^*$" style="vertical-align:-3px; 
                                     width:41px; 
                                     height:16px" class="math gen" /> を算出するために用いた当初データの標本変動によって左右される。</li><li id="a0000000047">坂元・石黒・北川 (1983) P.52, 式(4.37)</li><li id="a0000000049">実際は、<img src="images/img-0049.png" alt="$b$" style="vertical-align:0px; 
                                     width:7px; 
                                     height:11px" class="math gen" />の分布のばらつきが小さいとは限らないので（ネストされたモデルではばらつきは小さい）、点推定値で補正して良いのかという疑問も残る。</li>
</ol>
</div>

<div class="navigation">
<div class="online-navigation">
<hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="3 一般化線形モデル（GLM）" href="sect0003.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="データ解析のための統計モデリング入門" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="GLMの尤度比検定と検定の非対称性" href="sect0005.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">データ解析のための統計モデリング入門</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0003.html" class="sectref" rel="prev">一般化線形モデル（GLM）</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">データ解析のための統計モデリング入門</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0005.html" class="sectref" rel="next">GLMの尤度比検定と検定の非対称性</a></span>
</div>
</div>
<hr />
<!--
<span class="release-info">Release 2.4.3, documentation updated on 29 March 2006.</span>
-->
</div>
<!--End of Navigation Panel-->
<!--
<address>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</address>
-->
</body>
</html>