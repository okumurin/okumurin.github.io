<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="shortcut icon" href="icons/pyfav.png" type="image/png" />
<link href="index.html" title="多変量分散分析（SASによる実験データの解析：第14章）" rel="start" />
<link href="index.html" title="多変量分散分析（SASによる実験データの解析：第14章）" rel="first" />
<link href="index.html" rel="contents" title="Contents" />
<link rel="index" title="Index" />
<link href="sect0003.html" rel="next" />
<link href="sect0001.html" rel="prev" />
<link href="index.html" rel="parent" />
<meta name="aesop" content="information" />
<title>2 独立な2群の比較（従属変数が2つ以上）</title>
</head>
<body>
<div class="navigation">
<div id="top-navigation-panel" xml:id="top-navigation-panel">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="1 概要" href="sect0001.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="多変量分散分析（SASによる実験データの解析：第14章）" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="経時変化データ" href="sect0003.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">多変量分散分析（SASによる実験データの解析：第14章）</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0001.html" class="sectref" rel="prev">概要</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">多変量分散分析（SASによる実験データの解析：第14章）</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0003.html" class="sectref" rel="next">経時変化データ</a></span>
</div>
<hr /></div>
</div>



<div><h1 id="a0000000003">2 独立な2群の比較（従属変数が2つ以上）</h1>
<p>図<a href="sect0002.html#figdataliverweight">2.1</a>は、薬剤の投与によってラットの肝臓量と体重がどう変化するか検証するために集められたデータ <tt class="ttfamily">dataliverweight.csv</tt> である。 </p><div id="figdataliverweight" class="figure"><center> 
<img src="images/img-0001.png" alt="\includegraphics[width=8cm]{figdataliverweight.png}" style="width:8cm" /> <div class="caption"><b>Figure 2.1</b>: <span>薬剤の投与がラットの肝臓量（mg）と体重（g）に及ぼす影響</span></div>  </center></div><p>図<a href="sect0002.html#figplotdataliverweight">2.2</a>は薬剤の有無別にデータをプロットしたものである。 体重が同じであれば、薬ありの方が肝臓量は高い傾向にある。 </p><div id="figplotdataliverweight" class="figure"><center> 
<img src="images/img-0002.png" alt="\includegraphics[width=8cm]{figplotdataliverweight.png}" style="width:8cm" /> <div class="caption"><b>Figure 2.2</b>: <span>群別プロット</span></div>  </center></div><h2 id="a0000000008">2.1 Hotellingの<img src="images/img-0003.png" alt="$T^2$" style="vertical-align:0px; 
                                     width:18px; 
                                     height:14px" class="math gen" /></h2>
<p>特性<img src="images/img-0004.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />について、<img src="images/img-0005.png" alt="$i$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" />群の<img src="images/img-0006.png" alt="$j$" style="vertical-align:-3px; 
                                     width:7px; 
                                     height:14px" class="math gen" />番目の観測値を<img src="images/img-0007.png" alt="$x_{ijk}$" style="vertical-align:-5px; 
                                     width:27px; 
                                     height:12px" class="math gen" />とする。 このとき、通常の<img src="images/img-0008.png" alt="$t$" style="vertical-align:0px; 
                                     width:6px; 
                                     height:10px" class="math gen" />検定では、検定統計量 </p><table id="a0000000009" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000010">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0009.png" alt="$\displaystyle  t_ k  $" style="vertical-align:-3px; width:13px; 
                   height:13px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0010.png" alt="$\displaystyle = \frac{\bar{x}_{1k}-\bar{x}_{2k}}{\sqrt{ \left(\frac{1}{n_1}+\frac{1}{n_2} \right) S_ k^2}}  $" style="vertical-align:-39px; width:134px; 
                   height:62px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.1</span>)</span></td>
</tr>
</table><p> を用いる。 ただし、 </p><table id="a0000000011" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0011.png" alt="\begin{equation}  S_ k^2 = \frac{1}{n_1+n_2-2} \sum _{i=1}^2 \sum _{j=1}^{n_ i} \left( x_{ijk}-\bar{x}_{ik} \right)^2 \end{equation}" style="width:274px; 
                            height:50px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.3</span>)</span></td>
</tr>
</table><p> であり、特性<img src="images/img-0004.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />についてプールされた群内不偏分散を表す。 </p><p>ここで、 </p><table id="a0000000012" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0012.png" alt="\begin{equation}  t_ k^2= \left(\frac{1}{n_1}+\frac{1}{n_2} \right)^{-1} \left( \bar{x}_{1k}-\bar{x}_{2k} \right) \left( S^2_ k \right)^{-1} \left( \bar{x}_{1k}-\bar{x}_{2k} \right) \end{equation}" style="width:364px; 
                            height:44px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.4</span>)</span></td>
</tr>
</table><p> と表すこともできる。 </p><p>例のように特性が2個の場合、 </p><table id="a0000000013" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0013.png" alt="\begin{equation}  \bar{\bm@general \boldmath \m@ne \mv@bold \bm@command {x}}_ i = \begin{pmatrix}  \bar{x}_{i1} 

\\ \bar{x}_{i2} 

\end{pmatrix}, \bm@general \boldmath \m@ne \mv@bold \bm@command {V} = \begin{pmatrix}  v_{11} 

&amp;  v_{12} 

\\ v_{21} 

&amp;  v_{22} 

\end{pmatrix} \end{equation}" style="width:213px; 
                            height:40px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.5</span>)</span></td>
</tr>
</table><p> と定義する。 ただし、<img src="images/img-0014.png" alt="$v_{11}$" style="vertical-align:-3px; 
                                     width:21px; 
                                     height:10px" class="math gen" />と<img src="images/img-0015.png" alt="$v_{22}$" style="vertical-align:-3px; 
                                     width:21px; 
                                     height:10px" class="math gen" />はそれぞれ特性1と特性2に関するプールされた群内不偏分散（つまり<img src="images/img-0016.png" alt="$S_1^2$" style="vertical-align:-4px; 
                                     width:16px; 
                                     height:18px" class="math gen" />と<img src="images/img-0017.png" alt="$S_2^2$" style="vertical-align:-4px; 
                                     width:16px; 
                                     height:18px" class="math gen" />）、<img src="images/img-0018.png" alt="$v_{12}=v_{21}$" style="vertical-align:-3px; 
                                     width:65px; 
                                     height:10px" class="math gen" />は特性1と特性2に関するプールされた群内不偏共分散である。 一般には、<img src="images/img-0019.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {V}=\left\{  v_{kk'} \right\} $" style="vertical-align:-4px; 
                                     width:78px; 
                                     height:17px" class="math gen" />で </p><table id="a0000000014" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0020.png" alt="\begin{equation}  v_{kk'} = \frac{1}{n_1+n_2-2} \sum _{i=1}^2 \sum _{j=1}^{n_ i} \left( x_{ijk}-\bar{x}_{ik} \right) \left( x_{ijk'}-\bar{x}_{ik'} \right) \end{equation}" style="width:372px; 
                            height:50px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.6</span>)</span></td>
</tr>
</table><p> と書ける。 </p><p>このとき、 </p><table id="a0000000015" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0021.png" alt="\begin{equation}  T^2 = \left(\frac{1}{n_1}+\frac{1}{n_2} \right)^{-1} \left( \bar{\bm@general \boldmath \m@ne \mv@bold \bm@command {x}}_1 - \bar{\bm@general \boldmath \m@ne \mv@bold \bm@command {x}}_2 \right)’ \bm@general \boldmath \m@ne \mv@bold \bm@command {V}^{-1} \left( \bar{\bm@general \boldmath \m@ne \mv@bold \bm@command {x}}_1 - \bar{\bm@general \boldmath \m@ne \mv@bold \bm@command {x}}_2 \right) \end{equation}" style="width:328px; 
                            height:44px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.7</span>)</span></td>
</tr>
</table><p> をHotellingの<img src="images/img-0003.png" alt="$T^2$" style="vertical-align:0px; 
                                     width:18px; 
                                     height:14px" class="math gen" />統計量という。 </p><p>もし帰無仮説<img src="images/img-0022.png" alt="$H_0: \bm@general \boldmath \m@ne \mv@bold \bm@command {\mu }_1=\bm@general \boldmath \m@ne \mv@bold \bm@command {\mu }_2$" style="vertical-align:-4px; 
                                     width:92px; 
                                     height:15px" class="math gen" />が真で、観測値ベクトルが共通の群内母分散共分散行列をもつ多変量正規分布に従うなら、 </p><table id="a0000000016" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0023.png" alt="\begin{equation}  \frac{n_1+n_2-p-1}{p(n_2+n_2-2)} T^2 \sim F(p, n_1+n_2-p-1) \end{equation}" style="width:308px; 
                            height:38px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.8</span>)</span></td>
</tr>
</table><p> となり（<img src="images/img-0024.png" alt="$p$" style="vertical-align:-3px; 
                                     width:10px; 
                                     height:10px" class="math gen" />は特性の数）、<img src="images/img-0025.png" alt="$F$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />検定によってこの<img src="images/img-0026.png" alt="$H_0$" style="vertical-align:-3px; 
                                     width:20px; 
                                     height:14px" class="math gen" />を検定できる。 </p><h2 id="a0000000017">Rによる分析</h2>
<p> Rでは、<tt class="ttfamily">DescTools</tt>パッケージの関数 <tt class="ttfamily">HotellingsT2Test()</tt> によってHotellingの<img src="images/img-0003.png" alt="$T^2$" style="vertical-align:0px; 
                                     width:18px; 
                                     height:14px" class="math gen" />にもとづいた<img src="images/img-0025.png" alt="$F$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />検定を行うことができる。 </p><p>図<a href="sect0002.html#figdataliverweight">2.1</a>のデータ <tt class="ttfamily">dataliverweight.csv</tt> で肝臓量と体重の平均が薬の有無に関わらず等しいという帰無仮説を検定するには、以下のスクリプトを実行すればよい。 </p><blockquote class="quote"> <small class="small"><pre>
&gt; library("DescTools")
&gt; head(data01,5)
  個体 薬 肝臓量 体重
1    1  x    710  245
2    2  x    627  224
3    3  x    865  342
4    4  x   1064  403
5    5  x    736  214
&gt; HotellingsT2Test(cbind(肝臓量, 体重)~薬, data=data01)

	Hotelling's two sample T2-test

data:  cbind(肝臓量, 体重) by 薬
T.2 = 41.086, df1 = 2, df2 = 17, p-value = 3.087e-07
alternative hypothesis: true location difference is not equal to c(0,0)
</pre></small> </blockquote><p> <span class="normalsize"><p>このアウトプットでは<img src="images/img-0027.png" alt="$T^2=41.086$" style="vertical-align:0px; 
                                     width:86px; 
                                     height:14px" class="math gen" />であるかのように表示されているが、本当は<img src="images/img-0028.png" alt="$T^2=87.00$" style="vertical-align:0px; 
                                     width:78px; 
                                     height:14px" class="math gen" />であり、<tt class="ttfamily">T.2</tt>の値は<img src="images/img-0025.png" alt="$F$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />値である。 結果は、<img src="images/img-0029.png" alt="$F(2,17)=41.086, p = .000$" style="vertical-align:-4px; 
                                     width:193px; 
                                     height:18px" class="math gen" />と書ける。 </p></span></p><h2 id="a0000000018">2.2 平方和積和行列の分割</h2>
<p>特性が2つ以上の場合、ANOVAにおける平方和の分割を平方和積和行列の分割として以下のように拡張できる。 </p><table id="a0000000019" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0030.png" alt="\begin{equation}  \bm@general \boldmath \m@ne \mv@bold \bm@command {T} = \bm@general \boldmath \m@ne \mv@bold \bm@command {H} + \bm@general \boldmath \m@ne \mv@bold \bm@command {E} \end{equation}" style="width:85px; 
                            height:13px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.9</span>)</span></td>
</tr>
</table><p> ただし、<img src="images/img-0031.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {T} = \left\{  T_{kk'} \right\} $" style="vertical-align:-4px; 
                                     width:80px; 
                                     height:17px" class="math gen" />は総平方和積和行列、 </p><table id="a0000000020" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0032.png" alt="\begin{equation}  T_{kk'} = \sum _{i=1}^2 \sum _{j=1}^{n_ i} \left( x_{ijk}-\bar{x}_ k \right) \left( x_{ijk'}-\bar{x}_{k'} \right) \end{equation}" style="width:274px; 
                            height:50px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.10</span>)</span></td>
</tr>
</table><p> <img src="images/img-0033.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {H} = \left\{  H_{kk'} \right\} $" style="vertical-align:-4px; 
                                     width:87px; 
                                     height:17px" class="math gen" />は群間平方和積和行列、 </p><table id="a0000000021" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0034.png" alt="\begin{equation}  H_{kk'} = \sum _{i=1}^2 n_ i \left( \bar{x}_{ik}-\bar{x}_ k \right) \left( \bar{x}_{ik'}-\bar{x}_{k'} \right) \end{equation}" style="width:258px; 
                            height:48px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.11</span>)</span></td>
</tr>
</table><p> <img src="images/img-0035.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {E} = \left\{  E_{kk'} \right\} $" style="vertical-align:-4px; 
                                     width:83px; 
                                     height:17px" class="math gen" />は残差平方和積和行列 </p><table id="a0000000022" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000023">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0036.png" alt="$\displaystyle  E_{kk'}  $" style="vertical-align:-3px; width:30px; 
                   height:14px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0037.png" alt="$\displaystyle = \sum _{i=1}^2 \sum _{j=1}^{n_ i} \left( x_{ijk}-\bar{x}_{ik} \right) \left( x_{ijk'}-\bar{x}_{ik'} \right)  $" style="vertical-align:-21px; width:248px; 
                   height:50px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.12</span>)</span></td>
</tr><tr id="a0000000024">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0038.png" alt="$\displaystyle  $" style="vertical-align:0px; width:1px; 
                   height:1px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0039.png" alt="$\displaystyle = (n_1+n_2-2) v_{kk'}  $" style="vertical-align:-4px; width:139px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.13</span>)</span></td>
</tr>
</table><p> である。 </p><p>平方和積和行列の対角成分には特性<img src="images/img-0004.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />に関する平方和が、非対角成分には特性<img src="images/img-0004.png" alt="$k$" style="vertical-align:0px; 
                                     width:8px; 
                                     height:11px" class="math gen" />と<img src="images/img-0040.png" alt="$k’$" style="vertical-align:0px; 
                                     width:12px; 
                                     height:13px" class="math gen" />の積和（共分散<img src="images/img-0041.png" alt="$\times $" style="vertical-align:0px; 
                                     width:9px; 
                                     height:8px" class="math gen" />自由度）が格納されている。 </p><p>このとき、 </p><table id="a0000000025" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0042.png" alt="\begin{equation}  \bm@general \boldmath \m@ne \mv@bold \bm@command {E}^{-1} \bm@general \boldmath \m@ne \mv@bold \bm@command {H} \end{equation}" style="width:48px; 
                            height:16px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.14</span>)</span></td>
</tr>
</table><p> の固有値は、<img src="images/img-0043.png" alt="$l=\mathrm{min}(p,q)$" style="vertical-align:-4px; 
                                     width:90px; 
                                     height:18px" class="math gen" />個得られる<a href="#a0000000026" class="footnote"><sup class="footnotemark">1</sup></a>。 この固有値を<img src="images/img-0044.png" alt="$\lambda _1 \geq \lambda _2 \geq \cdots \geq \lambda _ l$" style="vertical-align:-3px; 
                                     width:133px; 
                                     height:14px" class="math gen" />とすると、検定のための統計量が4種類 </p><table id="a0000000027" class="eqnarray" cellspacing="0" cellpadding="7" width="100%">
<tr id="a0000000028">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0045.png" alt="$\displaystyle  \Lambda  $" style="vertical-align:0px; width:11px; 
                   height:11px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0046.png" alt="$\displaystyle = \frac{|\bm@general \boldmath \m@ne \mv@bold \bm@command {E}|}{|\bm@general \boldmath \m@ne \mv@bold \bm@command {H}+\bm@general \boldmath \m@ne \mv@bold \bm@command {E}|} = \prod _ i \frac{1}{1+\lambda _ i} \text {~ ~ ~ [Wilks’ lambda]}  $" style="vertical-align:-20px; width:319px; 
                   height:44px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.15</span>)</span></td>
</tr><tr id="a0000000029">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0047.png" alt="$\displaystyle V  $" style="vertical-align:0px; width:12px; 
                   height:11px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0048.png" alt="$\displaystyle = \mathrm{tr}(\bm@general \boldmath \m@ne \mv@bold \bm@command {H}) (\bm@general \boldmath \m@ne \mv@bold \bm@command {H}+\bm@general \boldmath \m@ne \mv@bold \bm@command {E})^{-1} = \sum _ i \frac{\lambda _ i}{1+\lambda _ i} \text {~ ~ ~ [Pillai’s trace]} $" style="vertical-align:-20px; width:366px; 
                   height:42px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.16</span>)</span></td>
</tr><tr id="a0000000030">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0049.png" alt="$\displaystyle U  $" style="vertical-align:0px; width:12px; 
                   height:11px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0050.png" alt="$\displaystyle = \mathrm{tr}(\bm@general \boldmath \m@ne \mv@bold \bm@command {E}^{-1}\bm@general \boldmath \m@ne \mv@bold \bm@command {H}) = \sum _ i \lambda _ i \text {~ ~ ~ [Hotelling-Lawley’s trace]} $" style="vertical-align:-20px; width:369px; 
                   height:36px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.17</span>)</span></td>
</tr><tr id="a0000000031">
    
    <td style="width:40%">&nbsp;</td>
    
    
        <td style="vertical-align:middle; 
                                  text-align:right"><img src="images/img-0051.png" alt="$\displaystyle \Theta  $" style="vertical-align:0px; width:11px; 
                   height:11px" class="math gen" /></td>
    
    
    
        <td style="vertical-align:middle; 
                                  text-align:left"><img src="images/img-0052.png" alt="$\displaystyle =\lambda _1 \text {~ ~ ~ [Roy’s largest root]}  $" style="vertical-align:-5px; width:203px; 
                   height:18px" class="math gen" /></td>
    
    
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.18</span>)</span></td>
</tr>
</table><p> 得られる。 </p><p>例のように2特性2群比較だと、<img src="images/img-0053.png" alt="$l=1$" style="vertical-align:0px; 
                                     width:34px; 
                                     height:12px" class="math gen" />であり、 </p><table id="a0000000032" class="equation" width="100%" cellspacing="0" cellpadding="7">
<tr>
    
    <td style="width:40%">&nbsp;</td>
    <td><img src="images/img-0054.png" alt="\begin{equation}  T^2 = (n_1+n_2-2) \lambda _1 \end{equation}" style="width:154px; 
                            height:19px" class="math gen" /></td>
    
    <td style="width:40%">&nbsp;</td>
    <td class="eqnnum" style="width:20%"><span>(<span>2.19</span>)</span></td>
</tr>
</table><p> が成り立つ。 </p><p><img src="images/img-0055.png" alt="$\Lambda , V, U, \Theta $" style="vertical-align:-3px; 
                                     width:67px; 
                                     height:14px" class="math gen" />は<img src="images/img-0053.png" alt="$l=1$" style="vertical-align:0px; 
                                     width:34px; 
                                     height:12px" class="math gen" />の時のみ等しい値を取り、かつ正確に<img src="images/img-0026.png" alt="$H_0$" style="vertical-align:-3px; 
                                     width:20px; 
                                     height:14px" class="math gen" />の下で<img src="images/img-0025.png" alt="$F$" style="vertical-align:0px; 
                                     width:13px; 
                                     height:11px" class="math gen" />分布に従う。 <img src="images/img-0056.png" alt="$l=2$" style="vertical-align:0px; 
                                     width:35px; 
                                     height:12px" class="math gen" />のときは<img src="images/img-0057.png" alt="$\Lambda $" style="vertical-align:0px; 
                                     width:11px; 
                                     height:11px" class="math gen" />のみが正確。 </p><h2 id="a0000000033">2.3 正準変量</h2>
<p><img src="images/img-0058.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {E}^{-1} \bm@general \boldmath \m@ne \mv@bold \bm@command {H}$" style="vertical-align:0px; 
                                     width:47px; 
                                     height:15px" class="math gen" />の固有ベクトルを用いて、もとのデータを<img src="images/img-0059.png" alt="$l$" style="vertical-align:0px; 
                                     width:5px; 
                                     height:11px" class="math gen" />個の正準変量に変換することができる。 これらを<img src="images/img-0060.png" alt="$C_1, C_2, \cdots , C_ l$" style="vertical-align:-3px; 
                                     width:101px; 
                                     height:14px" class="math gen" />とすると、<img src="images/img-0061.png" alt="$C_1$" style="vertical-align:-3px; 
                                     width:18px; 
                                     height:14px" class="math gen" />は群内平方和が1、群内積和が0となるように基準化されており、かつ群間平方和が最大値<img src="images/img-0062.png" alt="$\lambda _1$" style="vertical-align:-3px; 
                                     width:15px; 
                                     height:14px" class="math gen" />を取る。 また、<img src="images/img-0063.png" alt="$C_2$" style="vertical-align:-3px; 
                                     width:18px; 
                                     height:14px" class="math gen" />は<img src="images/img-0061.png" alt="$C_1$" style="vertical-align:-3px; 
                                     width:18px; 
                                     height:14px" class="math gen" />と無相関かつ群内平方和が1、群内積和が0で、群間平方和が最大値<img src="images/img-0064.png" alt="$\lambda _2$" style="vertical-align:-3px; 
                                     width:15px; 
                                     height:14px" class="math gen" />を取る。 以下同様。 </p><p>群間差を視覚的に把握するため、特性数が3以上、群の数が2以上の場合、正準変量を2次元平面上にプロットすることがある。 これを正準判別分析という。 </p><h2 id="a0000000034">Rによる分析</h2>
<p> Rでは、MANOVAによる分析を行うための関数 <tt class="ttfamily">manova()</tt> が装備されている。 </p><p>図<a href="sect0002.html#figdataliverweight">2.1</a>のデータ <tt class="ttfamily">dataliverweight.csv</tt> で肝臓量と体重の平均が薬の有無に関わらず等しいという帰無仮説をMANOVAによって検定するには、以下のスクリプトを実行すればよい。 </p><blockquote class="quote"> <small class="small"><pre>
&gt; fit01 &lt;- manova(cbind(肝臓量, 体重)~薬, data=data01)
&gt; summary(fit01, test="Wilks")
          Df   Wilks approx F num Df den Df    Pr(&gt;F)    
薬         1 0.17142   41.086      2     17 3.087e-07 ***
Residuals 18                                             
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
&gt; summary(fit01, test="Pillai") # デフォルト
          Df  Pillai approx F num Df den Df    Pr(&gt;F)    
薬         1 0.82858   41.086      2     17 3.087e-07 ***
Residuals 18                                             
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
&gt; summary(fit01, test="Hotelling-Lawley")
          Df Hotelling-Lawley approx F num Df den Df    Pr(&gt;F)    
薬         1           4.8337   41.086      2     17 3.087e-07 ***
Residuals 18                                                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
&gt; summary(fit01, test="Roy")
          Df    Roy approx F num Df den Df    Pr(&gt;F)    
薬         1 4.8337   41.086      2     17 3.087e-07 ***
Residuals 18                                            
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></small> </blockquote><p> <span class="normalsize"><p>この例は2群比較であるので、<img src="images/img-0053.png" alt="$l=1$" style="vertical-align:0px; 
                                     width:34px; 
                                     height:12px" class="math gen" />より4つの統計量いずれにもとづいても同じ結果が得られる。 </p><p>上記の例ではMANOVAで群間差が有意であったので、次に特性ごとのANOVAを行うことになる。 この場合、関数 <tt class="ttfamily">summary.aov()</tt> に <tt class="ttfamily">manova()</tt> の結果を渡せばよい。 </p><blockquote class="quote"> <small class="small"><pre>
&gt; summary.aov(fit01)
 Response 体重 :
            Df Sum Sq Mean Sq F value Pr(&gt;F)
薬           1   4590  4590.4  0.7883 0.3863
Residuals   18 104813  5823.0               

 Response 肝臓量 :
            Df Sum Sq Mean Sq F value Pr(&gt;F)  
薬           1  66817   66817  3.2366 0.0888 .
Residuals   18 371599   20644                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></small> </blockquote><p> <span class="normalsize"><p>この場合、MANOVAでは有意差が得られていたものが、体重と肝臓量それぞれについて検討すると、有意差なしという結果になる。 </p><p>上記の例で、平方和積和行列<img src="images/img-0065.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {H}, \bm@general \boldmath \m@ne \mv@bold \bm@command {E}$" style="vertical-align:-3px; 
                                     width:37px; 
                                     height:14px" class="math gen" />と<img src="images/img-0058.png" alt="$\bm@general \boldmath \m@ne \mv@bold \bm@command {E}^{-1} \bm@general \boldmath \m@ne \mv@bold \bm@command {H}$" style="vertical-align:0px; 
                                     width:47px; 
                                     height:15px" class="math gen" />の固有値は以下の通り。 </p><blockquote class="quote"> <small class="small"><pre>
&gt; summary(fit01)$SS
$薬
         肝臓量      体重
肝臓量  66816.8 -17513.40
体重   -17513.4   4590.45

$Residuals
         肝臓量     体重
肝臓量 371599.4 189145.9
体重   189145.9 104813.3

&gt; summary(fit01)$Eigenvalues
       [,1] [,2]
薬 4.833669    0
</pre></small> </blockquote><p><span class="normalsize"><p>後藤 (1973, p.212) を参照して正準変量を算出すると、以下の通り。 </p><blockquote class="quote"> <small class="small"><pre>
&gt; # E^(-1) %*% H の固有ベクトル
&gt; H &lt;- summary(fit01)$SS[[1]]
&gt; E &lt;- summary(fit01)$SS[[2]]
&gt; inverseE.H &lt;- solve(E) %*% H
&gt; eigen.v &lt;- eigen(inverseE.H)$vectors
&gt; 
&gt; c.v &lt;- cbind(scale(data01$肝臓量, scale=F), scale(data01$体重, scale=F)) %*% 
+              eigen.v    # 正準変量
&gt; colnames(c.v) &lt;- c("c1","c2")
&gt; data02 &lt;- cbind(data01[,1:2],c.v)
&gt; head(data02, n=3)
  個体 薬        c1         c2
1    1  x -53.79489  -70.81384
2    2  x -74.67694 -112.17194
3    3  x -65.66752   62.31613
</pre></small> </blockquote><p> <span class="normalsize"><p>図<a href="sect0002.html#figcanonicalplotdataliverweight">2.3</a>は薬剤の有無別に正準変量をプロットしたものである 。 </p><blockquote class="quote"><p> <span style="border: 1px solid black"><b class="bf">メモ</b></span> </p><p>後藤 (1973, p.212) では各変数から全体平均を引いたものに固有ベクトルをかけることで正準変量を求めている。 一方、「SASによる実験データの解析」図表 14.3（p.275）ではこれとメトリックが異なっているし、そもそもSASのアウトプットでは固有ベクトル（に何かを演算したもの）を用いて正準変量を算出している（図表14.2, p.272）。 この点については詳しく説明されていないのでよくわからない。 </p><div style="text-align:right"> <span style="border: 1px solid black"><b class="bf">メモここまで</b></span> </div></blockquote><div id="figcanonicalplotdataliverweight" class="figure"><center> 
<img src="images/img-0066.png" alt="\includegraphics[width=8cm]{figcanonicalplotdataliverweight.png}" style="width:8cm" /> <div class="caption"><b>Figure 2.3</b>: <span>群別正準変量プロット</span></div>  </center></div></span></p></span></p></span></p></span></p></div>

<div id="footnotes">
<p><b>Footnotes</b></p>
<ol>
<li id="a0000000026">一元配置の場合、<img src="images/img-0067.png" alt="$q=l-1$" style="vertical-align:-3px; 
                                     width:62px; 
                                     height:15px" class="math gen" /></li>
</ol>
</div>

<div class="navigation">
<div class="online-navigation">
<hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class="online-navigation"><a title="1 概要" href="sect0001.html" rel="prev"><img src="icons/previous.png" border="0" height="32" alt="Previous Page" width="32" /></a></td>
<td class="online-navigation"><a title="多変量分散分析（SASによる実験データの解析：第14章）" href="index.html" rel="parent"><img src="icons/up.png" border="0" height="32" alt="Up One Level" width="32" /></a></td>
<td class="online-navigation"><a title="経時変化データ" href="sect0003.html" rel="next"><img src="icons/next.png" border="0" height="32" alt="Next Page" width="32" /></a></td>
<td align="center" width="100%">多変量分散分析（SASによる実験データの解析：第14章）</td>
<td class="online-navigation"><a href="index.html" rel="contents" title="Table of Contents"><img src="icons/contents.png" border="0" height="32" alt="Contents" width="32" /></a></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" alt="" width="32" /></td>
<td class="online-navigation"><img src="icons/blank.png" border="0" height="32" width="32" /></td>
</tr></table>
<div class="online-navigation">
<span><b class="navlabel">Previous:</b>
<a href="sect0001.html" class="sectref" rel="prev">概要</a></span>
<span><b class="navlabel">Up:</b>
<a href="index.html" class="sectref" rel="parent">多変量分散分析（SASによる実験データの解析：第14章）</a></span>
<span><b class="navlabel">Next:</b>
<a href="sect0003.html" class="sectref" rel="next">経時変化データ</a></span>
</div>
</div>
<hr />
<!--
<span class="release-info">Release 2.4.3, documentation updated on 29 March 2006.</span>
-->
</div>
<!--End of Navigation Panel-->
<!--
<address>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</address>
-->
</body>
</html>