
<H3><A NAME="SECTION00052300000000000000">
正準変量</A>
</H3>

<P>
<tex2html_verbatim_mark>#math78#<tex2html_image_mark>#tex2html_wrap_inline1805#
<tex2html_verbatim_mark>mathend000#の固有ベクトルを用いて、もとのデータを<tex2html_image_mark>#tex2html_wrap_inline1807#
<tex2html_verbatim_mark>mathend000#個の正準変量に変換することができる。
これらを<tex2html_verbatim_mark>#math79#<tex2html_image_mark>#tex2html_wrap_inline1809#
<tex2html_verbatim_mark>mathend000#とすると、<tex2html_image_mark>#tex2html_wrap_inline1811#
<tex2html_verbatim_mark>mathend000#は群内平方和が1、群内積和が0となるように基準化されており、かつ群間平方和が最大値<tex2html_image_mark>#tex2html_wrap_inline1813#
<tex2html_verbatim_mark>mathend000#を取る。
また、<tex2html_image_mark>#tex2html_wrap_inline1815#
<tex2html_verbatim_mark>mathend000#は<tex2html_image_mark>#tex2html_wrap_inline1817#
<tex2html_verbatim_mark>mathend000#と無相関かつ群内平方和が1、群内積和が0で、群間平方和が最大値<tex2html_image_mark>#tex2html_wrap_inline1819#
<tex2html_verbatim_mark>mathend000#を取る。
以下同様。

<P>
群間差を視覚的に把握するため、特性数が3以上、群の数が2以上の場合、正準変量を2次元平面上にプロットすることがある。
これを<#395#>正準判別分析<#395#>という。

<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>Rでは、MANOVAによる分析を行うための関数 <TT>manova()</TT> が装備されている。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>図<A HREF=<tex2html_cr_mark>#figdataliverweight#398><tex2html_cr_mark></A>のデータ <TT>dataliverweight.csv</TT> で肝臓量と体重の平均が薬の有無に関わらず等しいという帰無仮説をMANOVAによって検定するには、以下のスクリプトを実行すればよい。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE></BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim12#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>この例は2群比較であるので、<tex2html_image_mark>#tex2html_wrap_inline1821#
<tex2html_verbatim_mark>mathend000#より4つの統計量いずれにもとづいても同じ結果が得られる。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>

<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>上記の例ではMANOVAで群間差が有意であったので、次に特性ごとのANOVAを行うことになる。
この場合、関数 <TT>summary.aov()</TT> に <TT>manova()</TT> の結果を渡せばよい。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE></BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim13#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>この場合、MANOVAでは有意差が得られていたものが、体重と肝臓量それぞれについて検討すると、有意差なしという結果になる。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>

<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>上記の例で、平方和積和行列<tex2html_verbatim_mark>#math80#<tex2html_image_mark>#tex2html_wrap_inline1823#
<tex2html_verbatim_mark>mathend000#と<tex2html_verbatim_mark>#math81#<tex2html_image_mark>#tex2html_wrap_inline1825#
<tex2html_verbatim_mark>mathend000#の固有値は以下の通り。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE></BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim14#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>

<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>後藤 (1973, p.212) を参照して正準変量を算出すると、以下の通り。
</BLOCKQUOTE>
<P>
<BLOCKQUOTE></BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim15#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>

<P>
図<A HREF=<tex2html_cr_mark>#figcanonicalplotdataliverweight#422><tex2html_cr_mark></A>は薬剤の有無別に正準変量をプロットしたものである
後藤 (1973, p.212) では各変数から全体平均を引いたものに固有ベクトルをかけることで正準変量を求めている。
一方、「SASによる実験データの解析」図表 14.3（p.275）ではこれとメトリックが異なっているし、そもそもSASのアウトプットでは固有ベクトル（に何かを演算したもの）を用いて正準変量を算出している（図表14.2, p.272）。
この点については詳しく説明されていないのでよくわからない。

<P>

<DIV ALIGN="CENTER"><A NAME="figcanonicalplotdataliverweight"><tex2html_anchor_mark></A><A NAME="426"><tex2html_anchor_mark></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG><#1826#>図<#1826#> 5.3:</STRONG>
<#1827#>群別正準変量プロット<#1827#></CAPTION>
<TR><TD><DIV ALIGN="CENTER">
<IMG
  WIDTH="315" HEIGHT="237" ALIGN="BOTTOM" BORDER="0"
 SRC="./figcanonicalplotdataliverweight.png"
 ALT="Image figcanonicalplotdataliverweight">

</DIV></TD></TR>
</TABLE>
</DIV>


<P>
